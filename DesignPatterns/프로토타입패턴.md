

# 프로토타입 패턴 (Prototype Pattern)

## 1. 개요

> **"클래스에서 새로운 인스턴스를 만드는 대신, 기존에 존재하는 객체를 복사하여 새로운 객체를 생성하는 패턴"**

게임 개발에서는 수많은 몬스터, 아이템, 투사체 등이 등장합니다. 이를 매번 클래스 생성자(`new`)로 만들기보다, 잘 설정된 '원본(Prototype)'을 하나 두고 이를 복제(Clone)하는 방식이 훨씬 효율적일 때가 많습니다.

---

## 2. 왜 사용하는가? (Motivation)

* **클래스 수 감소:** 몬스터의 종류가 100종류라고 해서 100개의 클래스를 만들 필요가 없습니다. 설정값(체력, 속도 등)이 다른 몇 개의 원본 객체만 있으면 됩니다.
* **복잡한 초기화 생략:** DB나 JSON 파일에서 데이터를 읽어와 객체를 설정하는 과정이 복잡할 경우, 한 번 로드된 객체를 복사해서 쓰는 것이 성능상 유리합니다.
* **런타임 유연성:** 게임 실행 중에 플레이어가 수정한 캐릭터나 아이템을 즉석에서 복제할 수 있습니다.

---

## 3. 구조와 구성 요소

1. **Prototype (Interface):** 자신을 복제하는 `Clone()` 메서드를 선언합니다.
2. **Concrete Prototype:** `Clone()` 메서드를 실제로 구현하며, 자신의 데이터를 복사한 새 객체를 반환합니다.
3. **Client:** `new` 키워드 대신 `Clone()`을 호출하여 새로운 객체를 얻습니다.

---

## 4. 코드 예시 (C#)

```csharp
using System;

// 1. Prototype 인터페이스
public abstract class Monster
{
    public int Health { get; set; }
    public int Speed { get; set; }

    public abstract Monster Clone(); // 복제를 위한 핵심 메서드
    public abstract void PrintStatus();
}

// 2. Concrete Prototype
public class Spawner : Monster
{
    public string Name { get; set; }

    public Spawner(string name, int hp, int speed)
    {
        this.Name = name;
        this.Health = hp;
        this.Speed = speed;
    }

    // 자신과 동일한 데이터를 가진 새 인스턴스 반환
    public override Monster Clone()
    {
        return new Spawner(this.Name, this.Health, this.Speed);
    }

    public override void PrintStatus()
    {
        Console.WriteLine($"[{Name}] HP: {Health}, Speed: {Speed}");
    }
}

// 3. Client 사용 예시
class Program
{
    static void Main()
    {
        // 원본 객체(Prototype) 생성
        Spawner ghostPrototype = new Spawner("유령", 100, 10);

        // 원본을 복제하여 새로운 몬스터들 생성
        Monster g1 = ghostPrototype.Clone();
        Monster g2 = ghostPrototype.Clone();

        g1.Health = 50; // 복제본의 상태를 변경해도 원본에 영향 없음

        ghostPrototype.PrintStatus(); // 원본 100
        g1.PrintStatus();             // 복제본 50
    }
}

```

---

## 5. 주의사항: Shallow vs Deep Copy

프로토타입 패턴을 구현할 때 가장 중요한 기술적 이슈입니다.

| 구분 | 방식 | 특징 |
| --- | --- | --- |
| **얕은 복사 (Shallow)** | 메모리 주소값만 복사 | 참조 타입(객체, 리스트 등) 공유 문제 발생 |
| **깊은 복사 (Deep)** | 실제 값 자체를 새 메모리에 복사 | 원본과 복제본이 완전히 독립됨 (권장) |

---

## 6. 요약

* **핵심 단어:** 복제(Clone), 원본(Prototype), 인스턴스 기반 생성.
* **장점:** 객체 생성 비용 절감, 동적인 객체 생성 가능.
* **단점:** 객체 내부에 순환 참조가 있거나 구조가 복잡하면 `Clone()` 구현이 까다로울 수 있음.

---
## 7. 게임 엔진에서
Prefab(프리팹): 미리 설정해둔 오브젝트(프로토타입)를 런타임에 Instantiate()로 복제해서 사용
